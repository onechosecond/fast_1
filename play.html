<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ㅍast ㅍashion</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="page">
    <a class="back-link" href="index.html">← 시작 화면으로</a>
    <header class="page-heading">
      <div class="actions-panel">
        <div class="action-buttons">
          <button class="btn action" id="calculate-btn" type="button" disabled>
            계산하기
          </button>
        </div>
    </header>

    <section class="game-stage">
      <div class="avatar-shell">
        <div class="avatar">
          <div class="avatar-images" id="avatar-images"></div>
        </div>
      </div>

      <div class="selection-panel-wrapper">
        <div class="selection-panel" id="selection-panel">
          <!-- 버튼 목록이 스크립트로 채워집니다 -->
        </div>
      </div>
    </section>

    <!-- 결과 모달 -->
    <div class="modal-overlay result-modal" id="result-modal">
      <div class="modal-content result-modal-content">
        <div class="result-card" id="result-card" aria-live="polite">
          <div class="badge" id="result-badge"></div>
          <h3 id="result-title"></h3>
          <p id="result-message"></p>
        </div>

        <div class="post-actions" id="post-actions">
          <button class="btn reset" type="button" id="reset-btn">다시하기</button>
          <a class="btn info-link" href="">
            진짜 헌 옷은 어떻게 구할 수 있을까?
          </a>
        </div>
      </div>
    </div>

    <!-- 게임 설명 팝업 -->
    <div class="modal-overlay" id="tutorial-modal">
      <div class="modal-content">
        <h2>HOW TO PLAY</h2>
        <div class="tutorial-content">
          <ol>
            <li> 상의, 하의, 액세서리 각각 하나씩 선택하세요.</li>
            <li> 계산하기 버튼을 눌러 총 가격을 확인하세요.</li>
            <li> 빈티지 쇼핑은 <strong>6만원 이상</strong> 쓰면 손해보는거에요.</li>
          </ol>
          <p>빈티지 가게는 헌 옷이 아닌 새 상품을 비싸게 팔기도 해요. 잘 골라보세요!</p>
        </div>
        <button class="btn primary" id="start-game-btn">코디 시작하기</button>
      </div>
    </div>

    <!-- 배경음악 -->
    <audio id="background-music" loop autoplay>
      <source src="nebula.mp3" type="audio/mpeg" />
      <source src="nebula.ogg" type="audio/ogg" />
    </audio>

    <script src="data.js"></script>
    <script src="play.js"></script>
    <script>
      (() => {
        // 배경음악 자동재생 및 반복재생 설정
        const bgMusic = document.getElementById("background-music");
        if (bgMusic) {
          bgMusic.volume = 0.3; // 볼륨 조절 (0.0 ~ 1.0)
          bgMusic.loop = true; // 반복재생
          
          // 자동재생 시도 (브라우저 정책으로 인해 사용자 상호작용 후 재생될 수 있음)
          const playPromise = bgMusic.play();
          if (playPromise !== undefined) {
            playPromise
              .then(() => {
                // 자동재생 성공
                console.log("Background music started");
              })
              .catch((error) => {
                // 자동재생 실패 (사용자 상호작용 필요)
                console.log("Autoplay prevented, will play after user interaction");
                // 사용자가 페이지와 상호작용하면 재생 시작
                document.addEventListener("click", () => {
                  bgMusic.play().catch((err) => {
                    console.log("Background music play failed:", err);
                  });
                }, { once: true });
              });
          }
        }
      })();
    </script>
  </body>
</html>
